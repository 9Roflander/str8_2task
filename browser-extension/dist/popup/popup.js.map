{
  "version": 3,
  "sources": ["../../src/popup/popup.js"],
  "sourcesContent": ["// Popup script for Meetily extension\n\nlet currentPlatform = null;\n\n// Initialize popup\ndocument.addEventListener('DOMContentLoaded', async () => {\n    await detectPlatform();\n    setupEventListeners();\n    startQueueStatusPolling();\n});\n\n// Detect which platform we're on\nasync function detectPlatform() {\n    try {\n        const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n\n        if (!tab) {\n            updateStatus(false, 'No active tab');\n            return;\n        }\n\n        // Retry logic: content script might not be ready yet\n        let retries = 3;\n        let response = null;\n\n        while (retries > 0 && !response) {\n            try {\n                response = await chrome.tabs.sendMessage(tab.id, { action: 'detectPlatform' });\n                if (response && response.platform) {\n                    break;\n                }\n            } catch (error) {\n                console.log(`Platform detection attempt failed, retries left: ${retries - 1}`);\n                retries--;\n                if (retries > 0) {\n                    await new Promise(resolve => setTimeout(resolve, 300)); // Wait 300ms before retry\n                }\n            }\n        }\n\n        if (response && response.platform) {\n            currentPlatform = response.platform;\n            const platformNames = {\n                'google-meet': 'Google Meet',\n                'zoom': 'Zoom',\n                'microsoft-teams': 'Microsoft Teams'\n            };\n            updateStatus(true, `Connected to ${platformNames[currentPlatform]}`);\n            enableButtons();\n        } else {\n            updateStatus(false, 'Not on a supported platform');\n        }\n    } catch (error) {\n        console.error('Error detecting platform:', error);\n        updateStatus(false, 'Not on a supported platform');\n    }\n}\n\n// Update status display\nfunction updateStatus(isActive, message) {\n    const statusEl = document.getElementById('status');\n    const statusDot = statusEl.querySelector('.status-dot');\n    const statusText = statusEl.querySelector('span');\n\n    if (isActive) {\n        statusEl.className = 'status active';\n    } else {\n        statusEl.className = 'status inactive';\n    }\n\n    statusText.textContent = message;\n}\n\n// Enable buttons when on a supported platform\nfunction enableButtons() {\n    document.getElementById('testLLMButton').disabled = false;\n    document.getElementById('postButton').disabled = false;\n}\n\n// Setup event listeners\nfunction setupEventListeners() {\n    // Test LLM message button\n    document.getElementById('testLLMButton').addEventListener('click', async () => {\n        const button = document.getElementById('testLLMButton');\n        const messageType = document.getElementById('messageType').value;\n\n        button.disabled = true;\n        button.textContent = 'Generating message...';\n\n        try {\n            // Generate test message\n            const response = await chrome.runtime.sendMessage({\n                action: 'generateTestMessage',\n                messageType: messageType\n            });\n\n            if (response.success) {\n                button.textContent = 'Posting message...';\n\n                // Post the generated message\n                await postMessage(response.message);\n\n                button.textContent = '\u2713 Message Posted!';\n                setTimeout(() => {\n                    button.textContent = 'Generate & Post Test Message';\n                    button.disabled = false;\n                }, 2000);\n            } else {\n                throw new Error(response.error || 'Failed to generate message');\n            }\n        } catch (error) {\n            console.error('Error with test message:', error);\n            button.textContent = '\u2717 Failed';\n            setTimeout(() => {\n                button.textContent = 'Generate & Post Test Message';\n                button.disabled = false;\n            }, 2000);\n            showError(error.message);\n        }\n    });\n\n    // Manual post button\n    document.getElementById('postButton').addEventListener('click', async () => {\n        const messageInput = document.getElementById('message');\n        const message = messageInput.value.trim();\n\n        if (!message) {\n            showError('Please enter a message');\n            return;\n        }\n\n        const button = document.getElementById('postButton');\n        button.disabled = true;\n        button.textContent = 'Posting...';\n\n        try {\n            await postMessage(message);\n\n            button.textContent = '\u2713 Posted!';\n            messageInput.value = '';\n\n            setTimeout(() => {\n                button.textContent = 'Post Message';\n                button.disabled = false;\n            }, 2000);\n        } catch (error) {\n            console.error('Error posting message:', error);\n            button.textContent = '\u2717 Failed';\n            setTimeout(() => {\n                button.textContent = 'Post Message';\n                button.disabled = false;\n            }, 2000);\n            showError(error.message);\n        }\n    });\n}\n\n// Post a message to the meeting\nasync function postMessage(message) {\n    return new Promise((resolve, reject) => {\n        chrome.runtime.sendMessage(\n            {\n                action: 'postMessage',\n                message: message,\n                platform: currentPlatform\n            },\n            (response) => {\n                if (chrome.runtime.lastError) {\n                    reject(new Error(chrome.runtime.lastError.message));\n                } else if (response && response.success) {\n                    resolve(response);\n                } else {\n                    reject(new Error(response?.error || 'Failed to post message'));\n                }\n            }\n        );\n    });\n}\n\n// Show error message\nfunction showError(message) {\n    const statusEl = document.getElementById('status');\n    const originalClass = statusEl.className;\n    const originalText = statusEl.querySelector('span').textContent;\n\n    updateStatus(false, `Error: ${message}`);\n\n    setTimeout(() => {\n        statusEl.className = originalClass;\n        statusEl.querySelector('span').textContent = originalText;\n    }, 3000);\n}\n\n// Poll queue status\nfunction startQueueStatusPolling() {\n    updateQueueStatus();\n    setInterval(updateQueueStatus, 1000);\n}\n\n// Update queue status display\nasync function updateQueueStatus() {\n    try {\n        const response = await chrome.runtime.sendMessage({ action: 'getQueueStatus' });\n\n        if (response) {\n            const queueStatusEl = document.getElementById('queueStatus');\n            const queueLengthEl = document.getElementById('queueLength');\n\n            queueLengthEl.textContent = response.queueLength;\n\n            if (response.queueLength > 0 || response.processing) {\n                queueStatusEl.classList.add('visible');\n            } else {\n                queueStatusEl.classList.remove('visible');\n            }\n        }\n    } catch (error) {\n        // Silently fail - queue status is not critical\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
