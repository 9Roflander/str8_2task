{
  "version": 3,
  "sources": ["../../src/background/test-api.js", "../../src/background/index.js"],
  "sourcesContent": ["/**\n * Mock LLM API for testing message generation\n * This simulates what the real Meetily app will provide\n */\n\nconst testMessages = {\n    acknowledgment: [\n        \"Thank you for sharing that insight.\",\n        \"That's a great point, I appreciate the clarification.\",\n        \"Understood, thanks for explaining.\",\n        \"I see what you mean, that makes sense.\",\n        \"Good to know, thank you!\"\n    ],\n    question: [\n        \"Could you elaborate on that point?\",\n        \"What are the next steps for this?\",\n        \"How does this align with our timeline?\",\n        \"Can you provide more details about the implementation?\",\n        \"What would be the best approach here?\"\n    ],\n    summary: [\n        \"To summarize: we'll proceed with the discussed approach.\",\n        \"Let me recap the key points from this discussion.\",\n        \"Just to confirm, we agreed on the following action items.\",\n        \"In summary, the main takeaways are...\",\n        \"To wrap up, here's what we've decided.\"\n    ]\n};\n\n/**\n * Generate a test LLM message\n * @param {string} type - Type of message: 'acknowledgment', 'question', or 'summary'\n * @returns {Promise<string>} Generated message\n */\nexport async function generateTestMessage(type = 'acknowledgment') {\n    // Simulate API delay\n    await new Promise(resolve => setTimeout(resolve, 500 + Math.random() * 500));\n\n    const messages = testMessages[type] || testMessages.acknowledgment;\n    const randomIndex = Math.floor(Math.random() * messages.length);\n\n    return messages[randomIndex];\n}\n\n/**\n * This will be replaced with real API call to Meetily app in Phase 2\n * @param {Object} context - Meeting context for LLM\n * @returns {Promise<string>} Generated message\n */\nexport async function generateLLMMessage(context) {\n    // TODO: In Phase 2, this will call the Meetily app API\n    // For now, use test message generation\n    return generateTestMessage(context.type || 'acknowledgment');\n}\n", "import { generateTestMessage } from './test-api.js';\n\n// Message queue for handling multiple LLM messages\nclass MessageQueue {\n    constructor() {\n        this.queue = [];\n        this.processing = false;\n    }\n\n    async add(message, platform, tabId) {\n        this.queue.push({ message, platform, tabId, timestamp: Date.now() });\n        console.log(`Added message to queue. Queue length: ${this.queue.length}`);\n\n        if (!this.processing) {\n            await this.process();\n        }\n    }\n\n    async process() {\n        if (this.processing || this.queue.length === 0) {\n            return;\n        }\n\n        this.processing = true;\n\n        while (this.queue.length > 0) {\n            const item = this.queue.shift();\n            console.log(`Processing message from queue. Remaining: ${this.queue.length}`);\n\n            try {\n                await this.sendMessage(item);\n                // Wait between messages to avoid overwhelming the platform\n                await new Promise(resolve => setTimeout(resolve, 1000));\n            } catch (error) {\n                console.error('Failed to send message:', error);\n                // Retry logic: add back to queue if failed (max 3 retries)\n                if (!item.retries || item.retries < 3) {\n                    item.retries = (item.retries || 0) + 1;\n                    console.log(`Retrying message (attempt ${item.retries}/3)`);\n                    this.queue.push(item);\n                    await new Promise(resolve => setTimeout(resolve, 2000)); // Wait before retry\n                }\n            }\n        }\n\n        this.processing = false;\n    }\n\n    async sendMessage({ message, platform, tabId }) {\n        return new Promise((resolve, reject) => {\n            chrome.tabs.sendMessage(\n                tabId,\n                {\n                    action: 'postMessage',\n                    message: message,\n                    platform: platform\n                },\n                (response) => {\n                    if (chrome.runtime.lastError) {\n                        reject(new Error(chrome.runtime.lastError.message));\n                    } else if (response && response.success) {\n                        console.log('Message posted successfully');\n                        resolve(response);\n                    } else {\n                        reject(new Error(response?.error || 'Unknown error'));\n                    }\n                }\n            );\n        });\n    }\n\n    getStatus() {\n        return {\n            queueLength: this.queue.length,\n            processing: this.processing\n        };\n    }\n}\n\nconst messageQueue = new MessageQueue();\n\n// Extension installation handler\nchrome.runtime.onInstalled.addListener((details) => {\n    console.log('Meetily extension installed:', details.reason);\n\n    if (details.reason === 'install') {\n        chrome.storage.local.set({\n            installed: true,\n            version: chrome.runtime.getManifest().version\n        });\n    }\n});\n\n// Handle messages from popup and content scripts\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n    console.log('Background received message:', request);\n\n    if (request.action === 'postMessage') {\n        chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n            if (tabs[0]) {\n                messageQueue.add(request.message, request.platform, tabs[0].id)\n                    .then(() => sendResponse({ success: true }))\n                    .catch((error) => sendResponse({ success: false, error: error.message }));\n            } else {\n                sendResponse({ success: false, error: 'No active tab found' });\n            }\n        });\n        return true; // Keep message channel open for async response\n    }\n\n    if (request.action === 'generateTestMessage') {\n        generateTestMessage(request.messageType)\n            .then((message) => {\n                sendResponse({ success: true, message });\n            })\n            .catch((error) => {\n                sendResponse({ success: false, error: error.message });\n            });\n        return true;\n    }\n\n    if (request.action === 'getQueueStatus') {\n        sendResponse(messageQueue.getStatus());\n        return true;\n    }\n});\n\n// Handle external messages from Meetily app (Phase 2)\nchrome.runtime.onMessageExternal.addListener((request, sender, sendResponse) => {\n    console.log('Background received external message from:', sender.url);\n    console.log('Request:', request);\n\n    if (request.action === 'postMessage') {\n        // Find the meeting tab\n        chrome.tabs.query({}, (tabs) => {\n            const meetingTab = tabs.find(tab =>\n                tab.url.includes('meet.google.com') ||\n                tab.url.includes('zoom.us') ||\n                tab.url.includes('teams.microsoft.com') ||\n                tab.url.includes('teams.live.com')\n            );\n\n            if (meetingTab) {\n                messageQueue.add(request.message, request.platform, meetingTab.id)\n                    .then(() => sendResponse({ success: true }))\n                    .catch((error) => sendResponse({ success: false, error: error.message }));\n            } else {\n                sendResponse({\n                    success: false,\n                    error: 'No active meeting tab found'\n                });\n            }\n        });\n        return true;\n    }\n\n    if (request.action === 'ping') {\n        sendResponse({ success: true, message: 'Extension is active' });\n        return true;\n    }\n});\n\n// Extension icon click handler (optional)\nchrome.action.onClicked.addListener((tab) => {\n    // Could open popup or perform action\n});\n\nconsole.log('Meetily background service worker initialized');\n"],
  "mappings": "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",
  "names": []
}
